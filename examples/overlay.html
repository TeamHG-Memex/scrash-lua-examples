<!DOCTYPE html>
<html>
  <head>
    <title>HH - Event Listeners</title>
    <script src="../js/headless_horseman_util.js"></script>
    <script>
      HH = __headless_horseman__
      HH.setDebug(true);
      HH.patchAddEventListener();
      HH.patchXhrSend();

      function onLoad() {
        setInterval(function () {
          makeOverlay();
        }, 4321);

        HH.startOverlayWatcher();
      }

      function makeOverlay() {
        if (document.getElementById('overlay')) {
          return;
        }

        var overlay = document.createElement('div');
        overlay.id = 'overlay';
        overlay.style.position = 'absolute';
        overlay.style.left = '100px';
        overlay.style.right = '100px';
        overlay.style.top = '100px';
        overlay.style.bottom = '100px';
        overlay.style.backgroundColor = 'black';
        overlay.style.opacity = 0.8;
        overlay.style.zIndex = 1;

        overlay.innerText = 'THIS IS AN OVERLAY!'
        overlay.style.color = 'white';
        overlay.style.fontSize = '48pt';
        overlay.style.fontWeight = 'bold';
        overlay.style.textAlign = 'center';
        overlay.style.paddingTop = '80px';

        document.body.appendChild(overlay);
      }
    </script>
  </head>

  <body style="max-width: 30em;" onload='onLoad()'>
    <h1>Overlay</h1>
    <p>
      <strong>
        This page will periodically open an overlay, and then HH will try to find it and close it.
        The div with the red outline has a z-index > 0 but will not be removed because it is so small.
      </strong>
    </p>
    <p>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean sed mi vel sem viverra molestie eget et ipsum. Quisque vitae tortor ut sapien eleifend ornare. Nulla at odio commodo justo finibus commodo. Suspendisse sagittis in dui venenatis bibendum. Ut at convallis diam. Aenean accumsan sagittis nulla nec commodo. Nullam imperdiet sodales sem eu ultrices.
    </p>
    <div style='float: right; border: 1px solid red; z-index: 1; margin: 5px; padding: 5px; font-size: 18pt; max-width: 50%;'>
      This div has a z-index > 0, but it's not an overlay.
      It will be checked once, marked as okay, and then ignored.
    </div>
    <p>
      Nulla feugiat urna nec ligula scelerisque porta. Etiam hendrerit ipsum nec tristique dictum. Morbi in tempor urna.
      Sed in risus mattis, commodo urna at, ultrices ex. Cras mollis nec velit eget lacinia. Mauris non quam tortor.
      Maecenas lectus tellus, tempor et nisi a, vehicula mollis leo. Nullam augue mi, dictum vulputate suscipit eu,
      placerat ac massa. Donec mattis nisl mattis enim venenatis porta. Nunc feugiat, tortor nec dignissim elementum,
      massa purus viverra ante, at luctus neque sapien vitae turpis. Donec accumsan, ligula id maximus hendrerit, dui
      purus consequat neque, malesuada lacinia erat turpis non justo.
    </p>
    <p>
      Suspendisse potenti. Phasellus eget pharetra quam. Nam ultricies semper augue quis hendrerit. Curabitur quis erat
      vel leo ornare congue. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis
      egestas. Morbi congue nibh eu arcu consequat aliquet. Curabitur auctor enim velit, eget rutrum mi accumsan at.
      Cras sagittis leo nec massa viverra, vitae lobortis augue iaculis. Maecenas tempus eget dolor id blandit. Integer
      feugiat nibh feugiat purus pretium, ut aliquet purus dignissim. Vestibulum ut ligula ac massa ornare pulvinar. Ut
      convallis vel lacus sed malesuada. Suspendisse vel bibendum sem, in ornare lacus. Integer fringilla ipsum ut quam
      hendrerit, ac mattis libero varius. Quisque vestibulum felis et ante mattis feugiat. Aliquam erat volutpat.
    </p>
    <p>
      Phasellus malesuada, erat id gravida ultrices, ligula quam faucibus ante, vel pulvinar dui ex sit amet nisi.
      Mauris nec arcu vel enim semper sollicitudin. Ut sollicitudin massa non blandit placerat. Nam dignissim mauris
      malesuada blandit sollicitudin. Aenean vitae laoreet ipsum. Nulla viverra accumsan lacus in consectetur. Integer
      laoreet pharetra sapien, at pulvinar quam ornare in. Curabitur scelerisque mollis enim et tristique. Donec sed
      augue enim. Donec vitae facilisis sapien.
    </p>
    <p>
      Aliquam sit amet sollicitudin erat. Morbi luctus, neque id eleifend cursus, tellus nulla fermentum lorem, at
      tincidunt odio quam eget massa. Etiam purus lacus, pharetra sed ipsum sed, egestas tempor elit. Maecenas eleifend
      turpis augue, non egestas tortor tincidunt vel. Morbi dapibus scelerisque sapien, ut interdum sem sollicitudin
      quis. Maecenas eget justo vel eros rhoncus luctus. Donec lectus lorem, tempus vel consequat ut, ornare ac nisi.
      Donec velit nisi, tincidunt vitae venenatis ac, porta eget massa.
    </p>
    <p>
      Etiam eleifend molestie sapien in ultrices. Morbi pulvinar eget ligula tempor vestibulum. Morbi nec nunc varius,
      luctus neque sed, efficitur lectus. Etiam ac diam ultricies, vestibulum mi varius, consectetur elit. Duis eget
      ante lacinia, porta eros sit amet, iaculis nibh. Cras euismod et enim et semper. Morbi libero nibh, iaculis vitae
      porta non, scelerisque a augue.
    </p>
    <p>
      In in porttitor purus. Nam consequat magna tortor, id euismod felis fringilla sed. Mauris placerat nunc diam, in
      dictum elit tincidunt ac. Proin hendrerit imperdiet porta. Proin laoreet rutrum tempus. Cras felis risus, sagittis
      ut lectus non, aliquet elementum augue. Donec vitae tempus leo. Aliquam ut lacinia magna. Vestibulum mollis arcu
      id maximus venenatis.
    </p>
  </body>
</html>
