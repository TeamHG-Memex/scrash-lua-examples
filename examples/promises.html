<!DOCTYPE html>
<html>
  <head>
    <title>HH - Promises</title>
    <script src="../js/headless_horseman_util.js"></script>
    <script>
      HH = __headless_horseman__
      HH.setDebug(true);
      HH.patchAddEventListener();
      HH.patchXhrSend();

      paragraphNumber = 1;

      function addParagraph() {
        var p = document.createElement('p');
        p.appendChild(document.createTextNode('This is paragraph #' + paragraphNumber++ + '.'));
        document.body.appendChild(p);
      }

      function onLoad() {
        HH.when(HH.debugLog, "Starting promise chain...")
          .then(HH.wait, 1000)
          .then(addParagraph)
          .then(HH.wait, 1000)
          .then(addParagraph)
          .then(HH.wait, 1000)
          .then(addParagraph)
          .then(HH.wait, 1000)
          .then(addParagraph)
          .then(HH.wait, 1000)
          .then(addParagraph)
          .then(HH.debugLog, "Finished promise chain.");
      }
    </script>
  </head>

  <body style="max-width: 30em;" onload='onLoad()'>
    <h1>Promises</h1>
    <p>
      <strong>
        The page will run 5 promises that are chained together and each one delays for 1 second.
        Each promise adds a paragraph of text to the body.
      </strong>
    </p>
  </body>
</html>
